LyogbWFpbiAqLwoKLyogcHJvZ3JhbSB0byBlbmNvZGUgYW5kIGRlY29kZSBmaWxlcyB0byBhbmQg
ZnJvbSBiYXNlNjQgKi8KLyogbGFzdCBtb2RpZmllZCAlRyUgdmVyc2lvbiAlSSUgKi8KCgojZGVm
aW5lCUNGX0RFQlVHUwkwCQkvKiBjb21waWxlLXRpbWUgKi8KI2RlZmluZQlDRl9ERUJVRwkwCQkv
KiBydW4tdGltZSAqLwojZGVmaW5lCUNGX0RFQlVHTUFMTAkxCQkvKiBkZWJ1ZyBtZW1vcnkgYWxs
b2NhdGlvbnMgKi8KCgovKiByZXZpc2lvbiBoaXN0b3J5OgoKCT0gMTk4OS0wMy0wMSwgRGF2aWQg
Qa1ErSBNb3Jhbm8KCglUaGlzIHN1YnJvdXRpbmUgd2FzIGJvcnJvd2VkIGZyb20gc29tZSBvdGhl
ciBjb2RlIG9mIG1pbmUgYW5kIGFkYXB0ZWQuCgoKKi8KCi8qIENvcHlyaWdodCCpIDE5ODkgRGF2
aWQgQa1ErSBNb3Jhbm8uICBBbGwgcmlnaHRzIHJlc2VydmVkLiAqLwoKLyoqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioKCglTeW5vcHNpczoKCgkkIGJhc2U2NCBbLWVkXSBbPGZpbGU+XSBbLXRdCgoKKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKi8KCgojaW5jbHVkZQk8ZW52c3RhbmRhcmRzLmg+CS8qIE1VU1Qg
YmUgZmlyc3QgdG8gY29uZmlndXJlICovCgojaW5jbHVkZQk8c3lzL3R5cGVzLmg+CiNpbmNsdWRl
CTxzeXMvcGFyYW0uaD4KI2luY2x1ZGUJPHVuaXN0ZC5oPgojaW5jbHVkZQk8ZmNudGwuaD4KI2lu
Y2x1ZGUJPHN0ZGxpYi5oPgojaW5jbHVkZQk8c3RyaW5nLmg+CiNpbmNsdWRlCTxjdHlwZS5oPgoj
aW5jbHVkZQk8bmV0ZGIuaD4KCiNpbmNsdWRlCTx2c3lzdGVtLmg+CiNpbmNsdWRlCTxiaXRzLmg+
CiNpbmNsdWRlCTxrZXlvcHQuaD4KI2luY2x1ZGUJPGJmaWxlLmg+CiNpbmNsdWRlCTx1Y21hbGxy
ZWcuaD4KI2luY2x1ZGUJPGV4aXRjb2Rlcy5oPgojaW5jbHVkZQk8bG9jYWxtaXNjLmg+CgojaW5j
bHVkZQkiY29uZmlnLmgiCiNpbmNsdWRlCSJkZWZzLmgiCgoKLyogbG9jYWwgZGVmaW5lcyAqLwoK
Ci8qIGV4dGVybmFsIHN1YnJvdXRpbmVzICovCgpleHRlcm4gaW50CXNmc2hyaW5rKGNvbnN0IGNo
YXIgKixpbnQsY29uc3QgY2hhciAqKikgOwpleHRlcm4gaW50CXNmc2tpcHdoaXRlKGNvbnN0IGNo
YXIgKixpbnQsY29uc3QgY2hhciAqKikgOwpleHRlcm4gaW50CW1hdG9zdHIoY29uc3QgY2hhciAq
KixpbnQsY29uc3QgY2hhciAqLGludCkgOwpleHRlcm4gaW50CWNmZGVjaShjb25zdCBjaGFyICos
aW50LGludCAqKSA7CmV4dGVybiBpbnQJb3B0Ym9vbChjb25zdCBjaGFyICosaW50KSA7CmV4dGVy
biBpbnQJb3B0dmFsdWUoY29uc3QgY2hhciAqLGludCkgOwpleHRlcm4gaW50CWlzZGlnaXRsYXRp
bihpbnQpIDsKCmV4dGVybiBpbnQJcHJpbnRoZWxwKHZvaWQgKixjb25zdCBjaGFyICosY29uc3Qg
Y2hhciAqLGNvbnN0IGNoYXIgKikgOwpleHRlcm4gaW50CXByb2dpbmZvX3NldHBpdihQUk9HSU5G
TyAqLGNjaGFyICosY29uc3Qgc3RydWN0IHBpdmFycyAqKSA7CmV4dGVybiBpbnQJcHJvZ2VuY29k
ZShQUk9HSU5GTyAqLGJmaWxlICosY29uc3QgY2hhciAqKSA7CmV4dGVybiBpbnQJcHJvZ2RlY29k
ZShQUk9HSU5GTyAqLGJmaWxlICosY29uc3QgY2hhciAqKSA7CgojaWYJQ0ZfREVCVUdTIHx8IENG
X0RFQlVHCmV4dGVybiBpbnQJZGVidWdvcGVuKGNvbnN0IGNoYXIgKikgOwpleHRlcm4gaW50CWRl
YnVncHJpbnRmKGNvbnN0IGNoYXIgKiwuLi4pIDsKZXh0ZXJuIGludAlkZWJ1Z2Nsb3NlKCkgOwpl
eHRlcm4gaW50CXN0cmxpbmVsZW4oY29uc3QgY2hhciAqLGludCxpbnQpIDsKI2VuZGlmCgpleHRl
cm4gY29uc3QgY2hhcgkqZ2V0b3VyZW52KGNvbnN0IGNoYXIgKiosY29uc3QgY2hhciAqKSA7Cgpl
eHRlcm4gY2hhcgkqc3Ryd2NweShjaGFyICosY29uc3QgY2hhciAqLGludCkgOwpleHRlcm4gY2hh
cgkqdGltZXN0cl9sb2codGltZV90LGNoYXIgKikgOwpleHRlcm4gY2hhcgkqdGltZXN0cl9lbGFw
c2VkKHRpbWVfdCxjaGFyICopIDsKCgovKiBleHRlcm5hbCB2YXJpYWJsZXMgKi8KCgovKiBmb3J3
YXJkIHJlZmVyZW5jZXMgKi8KCnN0YXRpYyBpbnQJdXNhZ2UoUFJPR0lORk8gKikgOwoKCi8qIGxv
Y2FsIHN0cnVjdHVyZXMgKi8KCgovKiBsb2NhbCB2YXJpYWJsZXMgKi8KCnN0YXRpYyBjb25zdCBj
aGFyCSphcmdvcHRzW10gPSB7CgkiVkVSU0lPTiIsCgkiVkVSQk9TRSIsCgkiSEVMUCIsCgkic24i
LAoJImFmIiwKCSJlZiIsCgkib2YiLAoJImlmIiwKCSJ0ZXh0IiwKCSJ0ZXN0IiwKCU5VTEwKfSA7
CgplbnVtIGFyZ29wdHMgewoJYXJnb3B0X3ZlcnNpb24sCglhcmdvcHRfdmVyYm9zZSwKCWFyZ29w
dF9oZWxwLAoJYXJnb3B0X3NuLAoJYXJnb3B0X2FmLAoJYXJnb3B0X2VmLAoJYXJnb3B0X29mLAoJ
YXJnb3B0X2lmLAoJYXJnb3B0X3RleHQsCglhcmdvcHRfdGVzdCwKCWFyZ29wdF9vdmVybGFzdAp9
IDsKCnN0YXRpYyBjb25zdCBzdHJ1Y3QgcGl2YXJzCWluaXR2YXJzID0gewoJVkFSUFJPR1JBTVJP
T1QxLAoJVkFSUFJPR1JBTVJPT1QyLAoJVkFSUFJPR1JBTVJPT1QzLAoJUFJPR1JBTVJPT1QsCglW
QVJQUk5BTUUKfSA7CgpzdGF0aWMgY29uc3Qgc3RydWN0IG1hcGV4CW1hcGV4c1tdID0gewoJeyBT
Ul9OT0VOVCwgRVhfTk9VU0VSIH0sCgl7IFNSX0FHQUlOLCBFWF9URU1QRkFJTCB9LAoJeyBTUl9E
RUFETEssIEVYX1RFTVBGQUlMIH0sCgl7IFNSX05PTENLLCBFWF9URU1QRkFJTCB9LAoJeyBTUl9U
WFRCU1ksIEVYX1RFTVBGQUlMIH0sCgl7IFNSX0FDQ0VTUywgRVhfTk9QRVJNIH0sCgl7IFNSX1JF
TU9URSwgRVhfUFJPVE9DT0wgfSwKCXsgU1JfTk9TUEMsIEVYX1RFTVBGQUlMIH0sCgl7IDAsIDAg
fQp9IDsKCgovKiBleHBvcnRlZCBzdWJyb3V0aW5lcyAqLwoKCmludCBtYWluKGludCBhcmdjLGNj
aGFyICphcmd2W10sY2NoYXIgKmVudnZbXSkKewoJUFJPR0lORk8JcGksICpwaXAgPSAmcGkgOwoJ
QklUUwkJcGFyZ3MgOwoJS0VZT1BUCQlha29wdHMgOwoJYmZpbGUJCWVycmZpbGUgOwoJYmZpbGUJ
CW91dGZpbGUsICpvZnAgPSAmb3V0ZmlsZSA7CgojaWYJKENGX0RFQlVHUyB8fCBDRl9ERUJVRykg
JiYgQ0ZfREVCVUdNQUxMCgl1aW50CQltb19zdGFydCA9IDAgOwojZW5kaWYKCglpbnQJCWFyZ3Is
IGFyZ2wsIGFvbCwgYWtsLCBhdmwsIGt3aSA7CglpbnQJCWFpLCBhaV9tYXgsIGFpX3BvcyA7Cglp
bnQJCXBhbiA9IDAgOwoJaW50CQlycywgcnMxIDsKCWludAkJZmMgOwoJaW50CQlleCA9IEVYX0lO
Rk8gOwoJaW50CQlmX29wdG1pbnVzLCBmX29wdHBsdXMsIGZfb3B0ZXF1YWwgOwoJaW50CQlmX3Zl
cnNpb24gPSBGQUxTRSA7CglpbnQJCWZfaGVscCA9IEZBTFNFIDsKCWludAkJZl91c2FnZSA9IEZB
TFNFIDsKCWludAkJZiA7CgoJY29uc3QgY2hhcgkqYXJncCwgKmFvcCwgKmFrcCwgKmF2cCA7Cglj
b25zdCBjaGFyCSphcmd2YWwgPSBOVUxMIDsKCWNvbnN0IGNoYXIJKnByID0gTlVMTCA7Cgljb25z
dCBjaGFyCSpzbiA9IE5VTEwgOwoJY29uc3QgY2hhcgkqYWZuYW1lID0gTlVMTCA7Cgljb25zdCBj
aGFyCSplZm5hbWUgPSBOVUxMIDsKCWNvbnN0IGNoYXIJKm9mbmFtZSA9IE5VTEwgOwoJY29uc3Qg
Y2hhcgkqaWZuYW1lID0gTlVMTCA7Cgljb25zdCBjaGFyCSpjcCA7CgojaWYJQ0ZfREVCVUdTIHx8
IENGX0RFQlVHCglpZiAoKGNwID0gZ2V0b3VyZW52KGVudnYsVkFSREVCVUdGTkFNRSkpICE9IE5V
TEwpIHsKCSAgICBycyA9IGRlYnVnb3BlbihjcCkgOwoJICAgIGRlYnVncHJpbnRmKCJtYWluOiBz
dGFydGluZyBERkQ9JWRcbiIscnMpIDsKCX0KI2VuZGlmIC8qIENGX0RFQlVHUyAqLwoKI2lmCShD
Rl9ERUJVR1MgfHwgQ0ZfREVCVUcpICYmIENGX0RFQlVHTUFMTAoJdWNfbWFsbHNldCgxKSA7Cgl1
Y19tYWxsb3V0KCZtb19zdGFydCkgOwojZW5kaWYKCglycyA9IHByb2dpbmZvX3N0YXJ0KHBpcCxl
bnZ2LGFyZ3ZbMF0sVkVSU0lPTikgOwoJaWYgKHJzIDwgMCkgewoJICAgIGV4ID0gRVhfT1NFUlIg
OwoJICAgIGdvdG8gcmV0MCA7Cgl9CgoJaWYgKChjcCA9IGdldGVudihWQVJCQU5ORVIpKSA9PSBO
VUxMKSBjcCA9IEJBTk5FUiA7Cglwcm9naW5mb19zZXRiYW5uZXIocGlwLGNwKSA7CgovKiBpbml0
aWFsaXplICovCgoJcGlwLT52ZXJib3NlbGV2ZWwgPSAxIDsKCglwaXAtPmYuZW5jb2RlID0gVFJV
RSA7CgovKiBzdGFydCBwYXJzaW5nIHRoZSBhcmd1bWVudHMgKi8KCglpZiAocnMgPj0gMCkgcnMg
PSBiaXRzX3N0YXJ0KCZwYXJncywxKSA7CglpZiAocnMgPCAwKSBnb3RvIGJhZHBhcmdzIDsKCgly
cyA9IGtleW9wdF9zdGFydCgmYWtvcHRzKSA7CglwaXAtPm9wZW4uYWtvcHRzID0gKHJzID49IDAp
IDsKCglhaV9tYXggPSAwIDsKCWFpX3BvcyA9IDAgOwoJYXJnciA9IGFyZ2MgOwoJZm9yIChhaSA9
IDAgOyAoYWkgPCBhcmdjKSAmJiAoYXJndlthaV0gIT0gTlVMTCkgOyBhaSArPSAxKSB7CgkgICAg
aWYgKHJzIDwgMCkgYnJlYWsgOwoJICAgIGFyZ3IgLT0gMSA7CgkgICAgaWYgKGFpID09IDApIGNv
bnRpbnVlIDsKCgkgICAgYXJncCA9IGFyZ3ZbYWldIDsKCSAgICBhcmdsID0gc3RybGVuKGFyZ3Ap
IDsKCgkgICAgZl9vcHRtaW51cyA9ICgqYXJncCA9PSAnLScpIDsKCSAgICBmX29wdHBsdXMgPSAo
KmFyZ3AgPT0gJysnKSA7CgkgICAgaWYgKChhcmdsID4gMSkgJiYgKGZfb3B0bWludXMgfHwgZl9v
cHRwbHVzKSkgewoJCWNvbnN0IGludAlhY2ggPSBNS0NIQVIoYXJncFsxXSkgOwoKCSAgICAgICAg
aWYgKGlzZGlnaXRsYXRpbihhY2gpKSB7CgoJICAgICAgICAgICAgYXJndmFsID0gKGFyZ3AgKyAx
KSA7CgoJICAgICAgICB9IGVsc2UgaWYgKGFjaCA9PSAnLScpIHsKCgkgICAgICAgICAgICBhaV9w
b3MgPSBhaSA7CgkgICAgICAgICAgICBicmVhayA7CgoJICAgICAgICB9IGVsc2UgewoKCSAgICAg
ICAgICAgIGFvcCA9IGFyZ3AgKyAxIDsKCSAgICAgICAgICAgIGFrcCA9IGFvcCA7CgkgICAgICAg
ICAgICBhb2wgPSBhcmdsIC0gMSA7CgkgICAgICAgICAgICBmX29wdGVxdWFsID0gRkFMU0UgOwoJ
ICAgICAgICAgICAgaWYgKChhdnAgPSBzdHJjaHIoYW9wLCc9JykpICE9IE5VTEwpIHsKCSAgICAg
ICAgICAgICAgICBmX29wdGVxdWFsID0gVFJVRSA7CgkgICAgICAgICAgICAgICAgYWtsID0gYXZw
IC0gYW9wIDsKCSAgICAgICAgICAgICAgICBhdnAgKz0gMSA7CgkgICAgICAgICAgICAgICAgYXZs
ID0gYW9wICsgYXJnbCAtIDEgLSBhdnAgOwoJICAgICAgICAgICAgICAgIGFvbCA9IGFrbCA7Cgkg
ICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgIGF2cCA9IE5VTEwgOwoJICAgICAg
ICAgICAgICAgIGF2bCA9IDAgOwoJICAgICAgICAgICAgICAgIGFrbCA9IGFvbCA7CgkgICAgICAg
ICAgICB9CgoJICAgICAgICAgICAgICAgIGlmICgoa3dpID0gbWF0b3N0cihhcmdvcHRzLDIsYWtw
LGFrbCkpID49IDApIHsKCgkgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoa3dpKSB7CgovKiB2
ZXJzaW9uICovCgkgICAgICAgICAgICAgICAgICAgIGNhc2UgYXJnb3B0X3ZlcnNpb246CgkgICAg
ICAgICAgICAgICAgICAgICAgICBmX3ZlcnNpb24gPSBUUlVFIDsKCSAgICAgICAgICAgICAgICAg
ICAgICAgIGlmIChmX29wdGVxdWFsKQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJzID0g
U1JfSU5WQUxJRCA7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhayA7CgovKiB2ZXJib3Nl
IG1vZGUgKi8KCSAgICAgICAgICAgICAgICAgICAgY2FzZSBhcmdvcHRfdmVyYm9zZToKCSAgICAg
ICAgICAgICAgICAgICAgICAgIHBpcC0+dmVyYm9zZWxldmVsID0gMiA7CgkgICAgICAgICAgICAg
ICAgICAgICAgICBpZiAoZl9vcHRlcXVhbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGZfb3B0ZXF1YWwgPSBGQUxTRSA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF2
bCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBycyA9IG9wdHZhbHVlKGF2cCxh
dmwpIDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGlwLT52ZXJib3NlbGV2ZWwg
PSBycyA7CgkJCQkgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAg
ICAgICAgICAgICAgYnJlYWsgOwoKLyogaGVscCAqLwoJICAgICAgICAgICAgICAgICAgICBjYXNl
IGFyZ29wdF9oZWxwOgoJICAgICAgICAgICAgICAgICAgICAgICAgZl9oZWxwID0gVFJVRSA7Cgkg
ICAgICAgICAgICAgICAgICAgICAgICBpZiAoZl9vcHRlcXVhbCkgewoJICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGZfb3B0ZXF1YWwgPSBGQUxTRSA7CgkgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaWYgKGF2bCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBycyA9IG9w
dGJvb2woYXZwLGF2bCkgOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmX2hlbHAg
PSAocnMgPiAwKSA7CgkJCQkgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAg
ICAgICAgICAgICAgICAgICAgYnJlYWsgOwoKLyogcHJvZ3JhbSBzZWFyY2gtbmFtZSAqLwoJICAg
ICAgICAgICAgICAgIGNhc2UgYXJnb3B0X3NuOgoJICAgICAgICAgICAgICAgICAgICBpZiAoZl9v
cHRlcXVhbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZl9vcHRlcXVhbCA9IEZBTFNFIDsK
CSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdmwpCgkgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc24gPSBhdnAgOwoJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAg
ICAgICAgICAgICAgICAgaWYgKGFyZ3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBh
cmdwID0gYXJndlsrK2FpXSA7CgkgICAgICAgICAgICAgICAgICAgICAgICBhcmdyIC09IDEgOwoJ
ICAgICAgICAgICAgICAgICAgICAgICAgYXJnbCA9IHN0cmxlbihhcmdwKSA7CgkgICAgICAgICAg
ICAgICAgICAgICAgICBpZiAoYXJnbCkKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbiA9
IGFyZ3AgOwoJCQkJfSBlbHNlCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnMgPSBTUl9J
TlZBTElEIDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBicmVh
ayA7CgovKiBhcmd1bWVudCBsaXN0IGZpbGUgKi8KCSAgICAgICAgICAgICAgICBjYXNlIGFyZ29w
dF9hZjoKCSAgICAgICAgICAgICAgICAgICAgaWYgKGZfb3B0ZXF1YWwpIHsKCSAgICAgICAgICAg
ICAgICAgICAgICAgIGZfb3B0ZXF1YWwgPSBGQUxTRSA7CgkgICAgICAgICAgICAgICAgICAgICAg
ICBpZiAoYXZsKQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmbmFtZSA9IGF2cCA7Cgkg
ICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAo
YXJnciA+IDApIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3AgPSBhcmd2WysrYWldIDsK
CSAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3IgLT0gMSA7CgkgICAgICAgICAgICAgICAgICAg
ICAgICBhcmdsID0gc3RybGVuKGFyZ3ApIDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChh
cmdsKQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmbmFtZSA9IGFyZ3AgOwoJCQkJfSBl
bHNlCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnMgPSBTUl9JTlZBTElEIDsKCSAgICAg
ICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBicmVhayA7CgovKiBlcnJvciBm
aWxlIG5hbWUgKi8KCSAgICAgICAgICAgICAgICBjYXNlIGFyZ29wdF9lZjoKCSAgICAgICAgICAg
ICAgICAgICAgaWYgKGZfb3B0ZXF1YWwpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGZfb3B0
ZXF1YWwgPSBGQUxTRSA7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXZsKQoJICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGVmbmFtZSA9IGF2cCA7CgkgICAgICAgICAgICAgICAgICAg
IH0gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJnciA+IDApIHsKCSAgICAg
ICAgICAgICAgICAgICAgICAgIGFyZ3AgPSBhcmd2WysrYWldIDsKCSAgICAgICAgICAgICAgICAg
ICAgICAgIGFyZ3IgLT0gMSA7CgkgICAgICAgICAgICAgICAgICAgICAgICBhcmdsID0gc3RybGVu
KGFyZ3ApIDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmdsKQoJICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGVmbmFtZSA9IGFyZ3AgOwoJCQkJfSBlbHNlCgkgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcnMgPSBTUl9JTlZBTElEIDsKCSAgICAgICAgICAgICAgICAgICAgfQoJ
ICAgICAgICAgICAgICAgICAgICBicmVhayA7CgovKiBvdXRwdXQgZmlsZSAqLwoJICAgICAgICAg
ICAgICAgICAgICBjYXNlIGFyZ29wdF9vZjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChm
X29wdGVxdWFsKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgZl9vcHRlcXVhbCA9IEZB
TFNFIDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXZsKQoJCQkJCW9mbmFtZSA9
IGF2cCA7CgkgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKGFyZ3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJn
cCA9IGFyZ3ZbKythaV0gOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3IgLT0gMSA7
CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnbCA9IHN0cmxlbihhcmdwKSA7CgkgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFyZ2wpCgkgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG9mbmFtZSA9IGFyZ3AgOwoJCQkJfSBlbHNlCgkgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcnMgPSBTUl9JTlZBTElEIDsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAg
ICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIDsKCi8qIGlucHV0IGZpbGUgKi8KCSAgICAgICAg
ICAgICAgICAgICAgY2FzZSBhcmdvcHRfaWY6CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAo
Zl9vcHRlcXVhbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZfb3B0ZXF1YWwgPSBG
QUxTRSA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF2bCkKCQkJCQlpZm5hbWUg
PSBhdnAgOwoJICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAg
ICAgICAgICAgIGlmIChhcmdyID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFy
Z3AgPSBhcmd2WysrYWldIDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdyIC09IDEg
OwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ2wgPSBzdHJsZW4oYXJncCkgOwoJICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcmdsKQoJICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpZm5hbWUgPSBhcmdwIDsKCQkJCX0gZWxzZQoJICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHJzID0gU1JfSU5WQUxJRCA7CgkgICAgICAgICAgICAgICAgICAgICAgICB9Cgkg
ICAgICAgICAgICAgICAgICAgICAgICBicmVhayA7CgoJCQkgICAgY2FzZSBhcmdvcHRfdGVzdDoK
CQkJCXBpcC0+Zi50ZXN0ID0gVFJVRSA7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZl9v
cHRlcXVhbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZfb3B0ZXF1YWwgPSBGQUxT
RSA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF2bCkgewoJICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBycyA9IG9wdGJvb2woYXZwLGF2bCkgOwoJCQkJCXBpcC0+Zi50
ZXN0ID0gKHJzID4gMCkgOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAg
ICAgICAgICAgICAgICAgIH0KCQkJCWJyZWFrIDsKCgkJCSAgICBjYXNlIGFyZ29wdF90ZXh0OgoJ
CQkJcGlwLT5mLnRleHQgPSBUUlVFIDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmX29w
dGVxdWFsKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgZl9vcHRlcXVhbCA9IEZBTFNF
IDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXZsKSB7CgkgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHJzID0gb3B0Ym9vbChhdnAsYXZsKSA7CgkJCQkJcGlwLT5mLnRl
eHQgPSAocnMgPiAwKSA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAg
ICAgICAgICAgICAgICAgfQoJCQkJYnJlYWsgOwoKLyogaGFuZGxlIGFsbCBrZXl3b3JkIGRlZmF1
bHRzICovCgkgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CgkJCQlycyA9IFNSX0lOVkFMSUQg
OwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgOwoKCSAgICAgICAgICAgICAgICAgICAg
fSAvKiBlbmQgc3dpdGNoICovCgoJICAgICAgICAgICAgICAgIH0gZWxzZSB7CgoJICAgICAgICAg
ICAgICAgICAgICB3aGlsZSAoYWtsLS0pIHsKCQkJCWNvbnN0IGludAlrYyA9IE1LQ0hBUigqYWtw
KSA7CgoJICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChrYykgewoKLyogZGVidWcgKi8K
CSAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0QnOgoJICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHBpcC0+ZGVidWdsZXZlbCA9IDEgOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGlmIChmX29wdGVxdWFsKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZfb3B0
ZXF1YWwgPSBGQUxTRSA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdmwp
IHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJzID0gb3B0dmFsdWUoYXZw
LGF2bCkgOwoJCQkJCSAgICBwaXAtPmRlYnVnbGV2ZWwgPSBycyA7CgkJCQkJfQoJICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayA7
CgovKiB2ZXJzaW9uICovCgkgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdWJzoKCSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBmX3ZlcnNpb24gPSBUUlVFIDsKCSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBicmVhayA7CgovKiBkZWNvZGUgKi8KCSAgICAgICAgICAgICAgICAgICAg
ICAgIGNhc2UgJ2QnOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpcC0+Zi5lbmNvZGUg
PSBGQUxTRSA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgOwoKLyogZW5jb2Rl
ICovCgkgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdlJzoKCSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBwaXAtPmYuZW5jb2RlID0gVFJVRSA7CgkgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgYnJlYWsgOwoKLyogdGV4dCBtb2RlICovCgkgICAgICAgICAgICAgICAgICAgICAgICBj
YXNlICd0JzoKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXAtPmYudGV4dCA9IFRSVUUg
OwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIDsKCi8qIHF1aWV0IG1vZGUgKi8K
CSAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3EnOgoJICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHBpcC0+Zi5xdWlldCA9IFRSVUUgOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGJyZWFrIDsKCi8qIHZlcmJvc2UgbW9kZSAqLwoJICAgICAgICAgICAgICAgICAgICAgICAgY2Fz
ZSAndic6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGlwLT52ZXJib3NlbGV2ZWwgPSAy
IDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZl9vcHRlcXVhbCkgewoJICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBmX29wdGVxdWFsID0gRkFMU0UgOwoJICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXZsKSB7CgkgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBycyA9IG9wdHZhbHVlKGF2cCxhdmwpIDsKCQkJCQkgICAgcGlwLT52ZXJi
b3NlbGV2ZWwgPSBycyA7CgkJCQkJfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayA7CgoJICAgICAgICAgICAgICAgICAgICAg
ICAgY2FzZSAnPyc6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgZl91c2FnZSA9IFRSVUUg
OwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIDsKCgkgICAgICAgICAgICAgICAg
ICAgICAgICBkZWZhdWx0OgoJCQkJICAgIHJzID0gU1JfSU5WQUxJRCA7CgkJCQkgICAgYnJlYWsg
OwoKCSAgICAgICAgICAgICAgICAgICAgICAgIH0gLyogZW5kIHN3aXRjaCAqLwoJICAgICAgICAg
ICAgICAgICAgICBha3AgKz0gMSA7CgoJICAgICAgICAgICAgICAgICAgICBpZiAocnMgPCAwKSBi
cmVhayA7CgkgICAgICAgICAgICAgICAgfSAvKiBlbmQgd2hpbGUgKi8KCgkgICAgICAgICAgICB9
IC8qIGVuZCBpZiAoaW5kaXZpZHVhbCBvcHRpb24ga2V5IGxldHRlcnMpICovCgoJICAgICAgICB9
IC8qIGVuZCBpZiAoZGlnaXRzIGFzIGFyZ3VtZW50IG9yIG5vdCkgKi8KCgkgICAgfSBlbHNlIHsK
CgkgICAgICAgIHJzID0gYml0c19zZXQoJnBhcmdzLGFpKSA7CgkgICAgICAgIGFpX21heCA9IGFp
IDsKCgkgICAgfSAvKiBlbmQgaWYgKGtleSBsZXR0ZXIvd29yZCBvciBwb3NpdGlvbmFsKSAqLwoK
CSAgICBhaV9wb3MgPSBhaSA7CgoJfSAvKiBlbmQgd2hpbGUgKGFsbCBjb21tYW5kIGxpbmUgYXJn
dW1lbnQgcHJvY2Vzc2luZykgKi8KCglpZiAoZWZuYW1lID09IE5VTEwpIGVmbmFtZSA9IGdldGVu
dihWQVJFRk5BTUUpIDsKCWlmIChlZm5hbWUgPT0gTlVMTCkgZWZuYW1lID0gZ2V0ZW52KFZBUkVS
Uk9SRk5BTUUpIDsKCWlmIChlZm5hbWUgPT0gTlVMTCkgZWZuYW1lID0gQkZJTEVfU1RERVJSIDsK
CWlmICgocnMxID0gYm9wZW4oJmVycmZpbGUsZWZuYW1lLCJ3Y2EiLDA2NjYpKSA+PSAwKSB7Cgkg
ICAgcGlwLT5lZnAgPSAmZXJyZmlsZSA7CgkgICAgcGlwLT5vcGVuLmVycmZpbGUgPSBUUlVFIDsK
CSAgICBiY29udHJvbCgmZXJyZmlsZSxCQ19TRVRCVUZMSU5FLFRSVUUpIDsKCX0KCglpZiAocnMg
PCAwKQoJICAgIGdvdG8gYmFkYXJnIDsKCiNpZglDRl9ERUJVRwoJaWYgKERFQlVHTEVWRUwoMikp
CgkgICAgZGVidWdwcmludGYoIm1haW46IGZpbmlzaGVkIHBhcnNpbmcgYXJndW1lbnRzXG4iKSA7
CiNlbmRpZgoKCWlmIChmX3ZlcnNpb24pIHsKCSAgICBicHJpbnRmKHBpcC0+ZWZwLCIlczogdmVy
c2lvbiAlc1xuIiwKCSAgICAgICAgcGlwLT5wcm9nbmFtZSxWRVJTSU9OKSA7Cgl9CgovKiBnZXQg
dGhlIHByb2dyYW0gcm9vdCAqLwoKCXJzID0gcHJvZ2luZm9fc2V0cGl2KHBpcCxwciwmaW5pdHZh
cnMpIDsKCglpZiAocnMgPj0gMCkKCSAgICBycyA9IHByb2dpbmZvX3NldHNlYXJjaG5hbWUocGlw
LFZBUlNFQVJDSE5BTUUsc24pIDsKCglpZiAocnMgPCAwKSB7CgkgICAgZXggPSBFWF9PU0VSUiA7
CgkgICAgZ290byByZXRlYXJseSA7Cgl9CgoJaWYgKHBpcC0+ZGVidWdsZXZlbCA+IDApIHsKCSAg
ICBicHJpbnRmKHBpcC0+ZWZwLCIlczogcHI9JXNcbiIscGlwLT5wcm9nbmFtZSxwaXAtPnByKSA7
CgkgICAgYnByaW50ZihwaXAtPmVmcCwiJXM6IHNuPSVzXG4iLHBpcC0+cHJvZ25hbWUscGlwLT5z
ZWFyY2huYW1lKSA7Cgl9IC8qIGVuZCBpZiAqLwoKCWlmIChmX3VzYWdlKQoJICAgIHVzYWdlKHBp
cCkgOwoKLyogaGVscCBmaWxlICovCgoJaWYgKGZfaGVscCkgewoJICAgIHByaW50aGVscChOVUxM
LHBpcC0+cHIscGlwLT5zZWFyY2huYW1lLEhFTFBGTkFNRSkgOwoJfSAvKiBlbmQgaWYgKi8KCglp
ZiAoZl92ZXJzaW9uIHx8IGZfaGVscCB8fCBmX3VzYWdlKQoJICAgIGdvdG8gcmV0ZWFybHkgOwoK
CglleCA9IEVYX09LIDsKCi8qIGluaXRpYWxpemUgc29tZSBzdHVmZiAqLwoKCWlmICgob2ZuYW1l
ID09IE5VTEwpIHx8IChvZm5hbWVbMF0gPT0gJ1wwJykpCgkJb2ZuYW1lID0gQkZJTEVfU1RET1VU
IDsKCglycyA9IGJvcGVuKG9mcCxvZm5hbWUsIndjdCIsMDY2NikgOwoJaWYgKHJzIDwgMCkgewoJ
ICAgIGV4ID0gRVhfQ0FOVENSRUFUIDsKCSAgICBicHJpbnRmKHBpcC0+ZWZwLCIlczogaW5hY2Nl
c3NpYmxlIG91dHB1dCAoJWQpXG4iLAoJICAgICAgICBwaXAtPnByb2duYW1lLHJzKSA7CgkgICAg
Z290byBiYWRvdXRvcGVuIDsKCX0KCi8qIGxvb3AgdGhyb3VnaCB0aGUgYXJndW1lbnRzIHByb2Nl
c3NpbmcgdGhlbSAqLwoKI2lmCUNGX0RFQlVHCglpZiAoREVCVUdMRVZFTCgyKSkKCSAgICBkZWJ1
Z3ByaW50ZigibWFpbjogY2hlY2tpbmcgZm9yIHBvc2l0aW9uYWwgYXJndW1lbnRzXG4iKSA7CiNl
bmRpZgoKCWZjID0gMCA7CgoJZm9yIChhaSA9IDEgOyBhaSA8IGFyZ2MgOyBhaSArPSAxKSB7CgoJ
ICAgIGYgPSAoYWkgPD0gYWlfbWF4KSAmJiAoYml0c190ZXN0KCZwYXJncyxhaSkgPiAwKSA7Cgkg
ICAgZiA9IGYgfHwgKChhaSA+IGFpX3BvcykgJiYgKGFyZ3ZbYWldICE9IE5VTEwpKSA7CgkgICAg
aWYgKGYpIHsKCSAgICAgICAgY3AgPSBhcmd2W2FpXSA7CgkJaWYgKGNwWzBdICE9ICdcMCcpIHsK
CSAgICAJICAgIHBhbiArPSAxIDsKCQkgICAgZmMgKz0gMSA7CgkJICAgIGlmIChwaXAtPmYuZW5j
b2RlKSB7CgkgICAgICAgICAgICAgICAgcnMgPSBwcm9nZW5jb2RlKHBpcCxvZnAsY3ApIDsKCQkg
ICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICBycyA9IHByb2dkZWNvZGUocGlwLG9mcCxjcCkg
OwoJCSAgICB9CgkJfQoJICAgIH0KCgkgICAgaWYgKHJzIDwgMCkgYnJlYWsgOwoJfSAvKiBlbmQg
Zm9yIChoYW5kbGluZyBwb3NpdGlvbmFsIGFyZ3VtZW50cykgKi8KCglpZiAoKHJzID49IDApICYm
IChmYyA9PSAwKSkgewoKCQlmYyArPSAxIDsKCQljcCA9ICItIiA7CgkJaWYgKHBpcC0+Zi5lbmNv
ZGUpIHsKCSAgICAgICAgcnMgPSBwcm9nZW5jb2RlKHBpcCxvZnAsY3ApIDsKCQl9IGVsc2UgewoJ
ICAgICAgICBycyA9IHByb2dkZWNvZGUocGlwLG9mcCxjcCkgOwoJCX0KCgl9IC8qIGVuZCBpZiAo
dXNpbmcgc3RhbmRhcmQgaW5wdXQpICovCgoJYmNsb3NlKG9mcCkgOwoKCWlmICgocGlwLT5kZWJ1
Z2xldmVsID4gMCkgJiYgKHJzIDwgMCkpIHsKCQlicHJpbnRmKHBpcC0+ZWZwLCIlczogb3BlcmF0
aW9uIGZhaWxlZCAoJWQpXG4iLAoJCQlwaXAtPnByb2duYW1lLHJzKSA7Cgl9CgpiYWRvdXRvcGVu
OgoJaWYgKChycyA8IDApICYmIChleCA9PSBFWF9PSykpIHsKCSAgICBleCA9IG1hcGV4KG1hcGV4
cyxycykgOwoJfQoKLyogd2UgYXJlIGRvbmUgKi8KcmV0ZWFybHk6CglpZiAocGlwLT5kZWJ1Z2xl
dmVsID4gMCkgewoJICAgIGJwcmludGYocGlwLT5lZnAsIiVzOiBleGl0aW5nIGV4PSV1ICglZClc
biIsCgkgICAgICAgIHBpcC0+cHJvZ25hbWUsZXgscnMpIDsKCX0KCglpZiAocGlwLT5lZnAgIT0g
TlVMTCkgewoJICAgIHBpcC0+b3Blbi5lcnJmaWxlID0gRkFMU0UgOwoJICAgIGJjbG9zZShwaXAt
PmVmcCkgOwoJICAgIHBpcC0+ZWZwID0gTlVMTCA7Cgl9CgoJaWYgKHBpcC0+b3Blbi5ha29wdHMp
IHsKCSAgICBrZXlvcHRfZmluaXNoKCZha29wdHMpIDsKCSAgICBwaXAtPm9wZW4uYWtvcHRzID0g
RkFMU0UgOwoJfQoKCWJpdHNfZmluaXNoKCZwYXJncykgOwoKYmFkcGFyZ3M6Cglwcm9naW5mb19m
aW5pc2gocGlwKSA7CgpyZXQwOgoKI2lmCShDRl9ERUJVR1MgfHwgQ0ZfREVCVUcpICYmIENGX0RF
QlVHTUFMTAoJewoJICAgIHVpbnQJbW8gOwoJICAgIHVjX21hbGxvdXQoJm1vKSA7CgkgICAgZGVi
dWdwcmludGYoIm1haW46IGZpbmFsIG1hbGxvdXQ9JXVcbiIsKG1vLW1vX3N0YXJ0KSkgOwoJICAg
IHVjX21hbGxzZXQoMCkgOwoJfQojZW5kaWYgLyogQ0ZfREVCVUdNQUxMICovCgojaWYJKENGX0RF
QlVHUyB8fCBDRl9ERUJVRykKCWRlYnVnY2xvc2UoKSA7CiNlbmRpZgoKCXJldHVybiBleCA7Cgov
KiB0aGUgYmFkIHRoaW5ncyAqLwpiYWRhcmc6CglleCA9IEVYX1VTQUdFIDsKCWJwcmludGYocGlw
LT5lZnAsIiVzOiBiYWQgYXJndW1lbnQocykgZ2l2ZW4gKCVkKVxuIiwKCSAgICBwaXAtPnByb2du
YW1lLHJzKSA7Cgl1c2FnZShwaXApIDsKCWdvdG8gcmV0ZWFybHkgOwoKfQovKiBlbmQgc3Vicm91
dGluZSAobWFpbikgKi8KCgovKiBsb2NhbCBzdWJyb3V0aW5lcyAqLwoKCnN0YXRpYyBpbnQgdXNh
Z2UoUFJPR0lORk8gKnBpcCkKewoJaW50CQlycyA9IFNSX09LIDsKCWludAkJd2xlbiA9IDAgOwoJ
Y29uc3QgY2hhcgkqcG4gPSBwaXAtPnByb2duYW1lIDsKCWNvbnN0IGNoYXIJKmZtdCA7CgoJZm10
ID0gIiVzOiBVU0FHRT4gJXMgWy1lfC1kXSBbPGZpbGU+XSBbLXRdXG4iIDsKCWlmIChycyA+PSAw
KSBycyA9IGJwcmludGYocGlwLT5lZnAsZm10LHBuLHBuKSA7Cgl3bGVuICs9IHJzIDsKCglmbXQg
PSAiJXM6ICBbLVFdIFstRF0gWy12Wz08bj5dXSBbLUhFTFBdIFstVl1cbiIgOwoJaWYgKHJzID49
IDApIHJzID0gYnByaW50ZihwaXAtPmVmcCxmbXQscG4pIDsKCXdsZW4gKz0gcnMgOwoKCXJldHVy
biAocnMgPj0gMCkgPyB3bGVuIDogcnMgOwp9Ci8qIGVuZCBzdWJyb3V0aW5lICh1c2FnZSkgKi8K
Cgo=
